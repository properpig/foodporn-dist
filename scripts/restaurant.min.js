!function(){"use strict";function t(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var a=new RegExp("[\\?&]"+t+"=([^&#]*)"),o=a.exec(location.search);return null===o?"":decodeURIComponent(o[1].replace(/\+/g," "))}function a(){$.getJSON(window.apiUrl+"/restaurant/"+c+"/"+window.username+"/",function(t){i=t.foods,s=t.deals,console.log(t),$(".sub-name").text(t.name),$(".main-div").html(m(t))}).done(function(){"reviews"===t("nav")&&setTimeout(function(){$(".infopage").eq(2).click()},1e3),$(".follow-button").click(function(t){var o=$(this).data("id");$.getJSON(window.apiUrl+"/restaurant/follow/"+o+"/"+window.username+"/",function(){a()}),$(this).toggleClass("following"),t.stopPropagation()}),$(".share-button").click(function(){if($(this).toggleClass("clicked"),$(this).hasClass("clicked")){$(this).attr("src","images/icons/share.svg"),$(".circle.share").show(),$(".circle.share").css({opacity:1});var t=$(".circle.share"),a=Math.PI/4*2/t.length,o=0,e=0,i=Math.PI/2;$(".circle.share").each(function(){o=150*Math.cos(i),e=160*Math.sin(i)-45,$(this).animate({right:o,top:e}),i-=a})}else $(".circle.share").animate({right:0,top:0,opacity:0},function(){$(".circle.share").hide(),$(".share-button").attr("src","images/icons/share-o.svg")})});var i;$(".circle.share").click(function(){var t=$(this).data("type");clearTimeout(i),$(".share-confirmation").show(),$(".share-confirmation .site").text(t),$(".share-confirmation").animate({bottom:15,opacity:1},500,function(){i=setTimeout(function(){$(".share-confirmation").animate({bottom:-100,opacity:0},function(){$(".share-confirmation").hide()})},1500)})}),$(".menu-items .modal-button").click(function(){n=$(this).data("index"),o(n);var t=$(this).attr("id");$("#modal-"+t).addClass("open"),$("#modal-"+t+" .modal").animate({marginTop:$(window).height()/9})}),$(".deal-items .modal-button").click(function(){l=$(this).data("index"),e(l);var t=$(this).attr("id");$("#modal-"+t).addClass("open"),$("#modal-"+t+" .modal").animate({marginTop:$(window).height()/11})})})}function o(t){var a=0!==t,e=t!==i.length-1;$("#modal-menu-item .modal").html(h({not_first:a,not_last:e,item:i[t]}));var s=$("#modal-menu-item .photo img").width();$("#modal-menu-item .photo img").height(s),$(".controls .right").click(function(t){n!==i.length-1&&(o(++n),t.stopPropagation())}),$(".controls .left").click(function(t){0!==n&&(o(--n),t.stopPropagation())})}function e(t){var a=0!==t,o=t!==s.length-1;$("#modal-restaurant-deals .modal").html(f({not_first:a,not_last:o,deals:s[t]}));var i=$("#modal-restaurant-deals .photo img").width();$("#modal-restaurant-deals .photo img").height(i),$(".controls .right").click(function(t){l!==s.length-1&&(e(++l),t.stopPropagation())}),$(".controls .left").click(function(t){0!==l&&(e(--l),t.stopPropagation())}),$(".main-buttons .close-deals-button").click(function(){$("#modal-restaurant-deals .modal").animate({marginTop:900},300,function(){$("#modal-restaurant-deals").removeClass("open")})})}var i,n,s,l,c=t("id"),r=$("#restaurant-template").html(),m=Handlebars.compile(r),d=$("#menu-template").html(),h=Handlebars.compile(d),u=$("#deals-template").html(),f=Handlebars.compile(u),p=!1;$(".main-div").scroll(function(){var t=-$(".main-photo").offset().top-$(".main-div").offset().top;return t>5?($(".sub-nav").removeClass("hidden"),t>100&&(t=100),$(".sub-nav").css({opacity:t/100}),p||$(".sub-nav").children().each(function(){var t=$(this).data("anchor"),a=$("."+t).offset().top-$(".main-div").offset().top-$(".sub-nav").offset().top;0>a&&($(".sub-nav-item").removeClass("selected"),$(this).addClass("selected"))}),void 0):($(".sub-nav").addClass("hidden"),void 0)}),$(".sub-nav-item").click(function(){$(".sub-nav-item").removeClass("selected"),$(this).addClass("selected");var t=$(this).data("anchor");p=!0,$(".main-div").animate({scrollTop:$("."+t).offset().top-$(".main-photo").offset().top-$(".sub-nav").height()},1e3,function(){p=!1})}),a()}();